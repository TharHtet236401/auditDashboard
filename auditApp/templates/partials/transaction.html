{% if transactions.count > 0 %}
<div class="table-responsive">
    <table class="table table-hover align-middle">
        <thead>
            <tr class="bg-light">
                <th scope="col" class="rounded-start-2 py-3">Merchant</th>
                <th scope="col" class="py-3">Amount</th>
                <th scope="col" class="py-3">Status</th>
                <th scope="col" class="py-3">Flag Status</th>
                <th scope="col" class="rounded-end-2 py-3">Approved By</th>
            </tr>
        </thead>
        <tbody class="table-group-divider">
            {% for transaction in transactions %}
            <tr class="align-middle cursor-pointer" 
                hx-get="{% url 'transaction_detail' transaction.id %}"
                hx-target="#transactionDetailModal .modal-content"
                hx-trigger="click"
                data-bs-toggle="modal" 
                data-bs-target="#transactionDetailModal">
                <td class="py-3">
                    <span class="fw-medium">{{ transaction.merchant }}</span>
                </td>
                <td class="py-3">
                    <span class="fw-medium">${{ transaction.amount }}</span>
                </td>
                <td class="py-3">
                    {% if transaction.status == 'Approved' %}
                        <span class="badge bg-success-subtle text-success border border-success-subtle px-3 py-2">
                            Approved
                        </span>
                    {% elif transaction.status == 'Pending' %}
                        <span class="badge bg-warning-subtle text-warning border border-warning-subtle px-3 py-2">
                            Pending
                        </span>
                    {% else %}
                        <span class="badge bg-danger-subtle text-danger border border-danger-subtle px-3 py-2">
                            {{ transaction.status }}
                        </span>
                    {% endif %}
                </td>
                <td class="py-3">
                    {% if transaction.isFlagged %}
                        <span class="badge bg-danger-subtle text-danger border border-danger-subtle px-3 py-2">
                            Flagged
                        </span>
                    {% else %}
                        <span class="badge bg-success-subtle text-success border border-success-subtle px-3 py-2">
                            Clear
                        </span>
                    {% endif %}
                </td>
                <td class="py-3">
                    <span class="fw-medium">{{ transaction.approved_by|default:"Not Approved" }}</span>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Modal for Transaction Details -->
<div class="modal fade" id="transactionDetailModal" tabindex="-1" aria-labelledby="transactionDetailModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <!-- Loading spinner -->
            <div class="d-flex justify-content-center p-5">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
            </div>
        </div>
    </div>
</div>

{% else %}
<div class="alert alert-info" role="alert">
    No transactions found
</div>
{% endif %}

